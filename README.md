Puppet Profile Parser
=====================

[![Build Status](https://travis-ci.org/Sharpie/puppet-profile-parser.svg?branch=master)](https://travis-ci.org/Sharpie/puppet-profile-parser)

Tools for parsing profile information from Puppet Server logs.


Installation
------------

The tools in this repository require some Ruby gems to function. These
requirements are listed in the [Gemfile](Gemfile) and can be installed
using [Bundler][bundler-web]:

    bundle install --without development

  [bundler-web]: http://bundler.io/#getting-started


Usage
-----

### Collecting Profiles

The `profile-parser.rb` script scans Puppet Server logs for information
generated by Puppet profiling code. This profiling code must be activated
using Puppet's [profile setting][profile-setting].

  [profile-setting]: https://puppet.com/docs/puppet/5.4/configuration.html#profile

#### Profiling specific agents

A single server profile can be collected for an agent by executing a test run
with the `--profile` flag:

    puppet agent -t --profile

Setting `profile=true` in the `[agent]` section of `puppet.conf` and restarting
the `puppet` daemon will cause all runs to generate server profiling
information. The profile results will be located in the Puppet Server logs.

#### Profiling all agents

Profiling can be enabled globally by setting `profile=true` in the `[master]`
section of `puppet.conf` and restarting the `puppetserver` daemon.

### Parsing Profiles

The `profile-parser.rb` script expects list of Puppet Server
log files containing `PROFILE` entries:

    ./profile-parser.rb .../path/to/puppetserver.log [.../more/logs]
